<div class="max-w-6xl mx-auto px-4 py-8">
  <div class="mb-6">
    <%= link_to "← Back to Characters", characters_path, class: "text-blue-600 hover:text-blue-800 underline" %>
  </div>

  <div class="flex flex-col items-center">
    <h1 class="flex items-center text-3xl font-bold mb-6">
      <% if @character.profile_picture.attached? %>
        <%= image_tag url_for(@character.profile_picture), alt: "#{@character.name} profile picture", class: "h-16 w-16 object-cover rounded-full mr-4 shadow-lg border-2 border-gray-300" %>
      <% end %>
      <span><%= @character.name %></span>
    </h1>

    <ul class="bg-white rounded-lg shadow-md p-8 w-full max-w-xl space-y-4">
      <li>
        <div class="flex flex-wrap gap-4 mt-2 text-gray-900">
          <span><strong>STR</strong>: <%= @character.strength %></span>
          <span><strong>DEX</strong>: <%= @character.dexterity %></span>
          <span><strong>CON</strong>: <%= @character.constitution %></span>
          <span><strong>INT</strong>: <%= @character.intelligence %></span>
          <span><strong>WIS</strong>: <%= @character.wisdom %></span>
          <span><strong>CHA</strong>: <%= @character.charisma %></span>
        </div>
      </li>
      <li>
        <div class="flex flex-wrap gap-6 items-center">
          <div>
            <strong class="text-gray-700">Class:</strong>
            <span class="text-gray-900"><%= @character.character_class %></span>
          </div>
          <div>
            <strong class="text-gray-700">Subclass:</strong>
            <span class="text-gray-900"><%= @character.subclass %></span>
          </div>
          <div>
            <strong class="text-gray-700">Species:</strong>
            <span class="text-gray-900"><%= @character.species %></span>
          </div>
        </div>
      </li>
      <li>
        <div class="flex flex-wrap gap-6 items-center">
          <div>
            <strong class="text-gray-700">Level:</strong>
            <span class="text-gray-900"><%= @character.level %></span>
          </div>
          <div>
            <strong class="text-gray-700">Hitpoints:</strong>
            <span class="text-gray-900"><%= @character.hitpoints %></span>
          </div>
          <div>
            <strong class="text-gray-700">AC:</strong>
            <span class="text-gray-900"><%= 10 + ((@character.dexterity - 10) / 2).floor %></span>
          </div>
          <div>
            <strong class="text-gray-700">Speed:</strong>
            <span class="text-gray-900"><%= @character.speed %> ft</span>
          </div>
        </div>
      </li>
      <li>
        <div class="flex flex-wrap gap-6 items-center">
          <div class="w-full">
            <div class="flex justify-between items-center mb-2">
              <strong class="text-gray-700">Recent Notes:</strong>
              <%= link_to "View All Notes", character_notes_path(@character), class: "text-blue-600 underline" %>
            </div>
            <div class="flex flex-row gap-4">
              <% @character.notes.order(updated_at: :desc).limit(2).each do |note| %>
                <div class="bg-gray-100 rounded-lg p-4 shadow w-60 flex flex-col">
                  <div class="font-semibold text-gray-800 truncate"><%= note.title %></div>
                  <div class="text-gray-700 text-sm truncate mb-2"><%= note.body.to_s.truncate(60) %></div>
                  <div class="flex gap-2 mt-auto">
                    <%= link_to "View", character_note_path(@character, note), class: "text-blue-600 underline text-xs" %>
                    <%= link_to "Edit", edit_character_note_path(@character, note), class: "text-green-600 underline text-xs" %>
                    <%= link_to "Delete", character_note_path(@character, note), method: :delete, data: { confirm: "Are you sure?" }, class: "text-red-600 underline text-xs" %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </li>
      <li>
        <strong class="text-gray-700">Feats:</strong>
        <ul class="list-disc ml-6 text-gray-900">
          <% @character.feats&.each do |feat| %>
            <li><%= feat %></li>
          <% end %>
        </ul>
      </li>
      <li>
        <strong class="text-gray-700">Items:</strong>
        <div class="ml-6">
          <div>
            <ul class="list-disc ml-6 text-gray-900">
              <% @character.items&.each do |item| %>
                <li><%= item %></li>
              <% end %>
            </ul>
          </div>
        </div>
      </li>
    </ul>

    <div class="mt-8 flex space-x-4">
      <%= link_to "Play Battle", play_character_path(@character), class: "px-6 py-2 bg-purple-600 text-white rounded shadow hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-opacity-50 transition" %>
      <%= link_to "Edit Character", edit_character_path(@character), class: "px-6 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50 transition" %>
      <% if @character.game_profile %>
        <span class="text-sm text-gray-600 px-6 py-2">
          • Game Level: <%= @character.game_profile.level %>
          • XP: <%= @character.game_profile.exp %>
          • Gold: <%= @character.game_profile.gold %>
        </span>
      <% end %>
    </div>
  </div>
</div>
